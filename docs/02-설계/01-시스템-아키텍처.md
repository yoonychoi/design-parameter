# 01. 시스템 아키텍처

> 작성일: 2026-02-19

---

## 1. 시스템 개요

클라이언트 전용 SPA(Single Page Application)로, 서버 없이 브라우저에서 모든 계산과 렌더링을 수행한다.

```
┌─────────────────────────────────────────────┐
│                 브라우저                      │
│                                             │
│  ┌───────────────────────────────────────┐  │
│  │           React Application           │  │
│  │                                       │  │
│  │  ┌─────────┐  ┌──────────────────┐   │  │
│  │  │  UI     │  │  상태 관리        │   │  │
│  │  │  Layer  │◄►│  (React State)   │   │  │
│  │  │         │  │                  │   │  │
│  │  └─────────┘  └────────┬─────────┘   │  │
│  │                        │             │  │
│  │               ┌────────▼─────────┐   │  │
│  │               │   계산 엔진      │   │  │
│  │               │  (순수 함수)     │   │  │
│  │               └────────┬─────────┘   │  │
│  │                        │             │  │
│  │               ┌────────▼─────────┐   │  │
│  │               │  엑셀 내보내기   │   │  │
│  │               │  (SheetJS)       │   │  │
│  │               └──────────────────┘   │  │
│  └───────────────────────────────────────┘  │
└─────────────────────────────────────────────┘
```

---

## 2. 기술 스택

| 구분 | 기술 | 버전 | 용도 |
|------|------|------|------|
| 언어 | TypeScript | 5.x | 타입 안전성 |
| 프레임워크 | React | 18.x | UI 컴포넌트 |
| 빌드 도구 | Vite | 6.x | 빌드, 개발 서버 |
| 스타일링 | Tailwind CSS | 3.x | UI 스타일링 |
| 차트 | Chart.js + react-chartjs-2 | 4.x | N값 분포 그래프 |
| 엑셀 | SheetJS (xlsx) | 0.20.x | 엑셀 파일 생성/다운로드 |
| 아이콘 | Lucide React | - | UI 아이콘 |

---

## 3. 아키텍처 레이어

### 3.1 UI Layer (컴포넌트)

- 탭 네비게이션, 입력 폼, 테이블, 차트 등 사용자 인터페이스
- 각 탭은 독립된 페이지 컴포넌트로 구성
- 공통 UI 컴포넌트(동적 테이블, 입력 필드, 팝오버 등) 재사용

### 3.2 State Layer (상태 관리)

- React Context + useReducer로 전역 상태 관리
- 단일 ProjectState에 모든 데이터 보관
- 상위 모듈 값 변경 시 하위 모듈 자동 재계산 (파생 상태)

### 3.3 Calculation Layer (계산 엔진)

- 순수 함수로 구현된 경험식 모듈
- 입력값을 받아 산정값을 반환 (부작용 없음)
- 모듈별 독립 파일로 분리

### 3.4 Export Layer (내보내기)

- SheetJS를 사용하여 엑셀 파일 생성
- 요약 시트 + 모듈별 상세 시트

---

## 4. 상태 관리 설계

```
ProjectContext (React Context)
│
├── state: ProjectState
│     ├── layers: Layer[]
│     ├── boreholes: Borehole[]
│     ├── frictionAngle: FrictionAngleResult[]
│     ├── cohesion: CohesionResult[]
│     ├── deformationModulus: DeformationModulusResult[]
│     ├── subgradeReaction: SubgradeReactionResult[]
│     ├── anchorFriction: AnchorFrictionResult[]
│     ├── permeability: PermeabilityResult[]
│     └── finalSummary: FinalSummary[]
│
└── dispatch: (action: Action) => void
      ├── ADD_LAYER / REMOVE_LAYER
      ├── ADD_BOREHOLE / REMOVE_BOREHOLE
      ├── ADD_MEASUREMENT / UPDATE_MEASUREMENT / REMOVE_MEASUREMENT
      ├── UPDATE_FRICTION_ANGLE
      ├── UPDATE_COHESION
      ├── UPDATE_DEFORMATION_MODULUS
      ├── UPDATE_SUBGRADE_REACTION
      ├── UPDATE_ANCHOR_FRICTION
      ├── UPDATE_PERMEABILITY
      └── UPDATE_FINAL_SUMMARY
```

### 파생 상태 (Derived State)

Reducer에서 상위 모듈 액션 처리 시 하위 모듈도 함께 재계산한다.

```
layers/boreholes 변경
  → layerSummaries 재계산 (대표N값)
    → frictionAngle 재계산
      → cohesion 재계산
        → deformationModulus 재계산
          → subgradeReaction 재계산
            → anchorFriction 재계산
              → permeability 재계산 (N값 무관, 독립)
                → finalSummary 재계산
```

---

## 5. 배포 구성

```
Vite Build → 정적 파일 (HTML/JS/CSS)
                │
                ▼
        정적 호스팅 서비스
        (Vercel / Netlify / GitHub Pages)
```

- `vite build` → `dist/` 폴더에 번들 생성
- 서버 사이드 로직 없음, CDN 배포 가능
- 환경변수 불필요 (외부 API 호출 없음)
