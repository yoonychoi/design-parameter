# 설계지반정수 산정 프로그램: 오류 점검 및 최적화 분석

작성일: 2026-02-19
대상 경로: app/

## 1. 점검 범위

- 정적 점검: npm run lint
- 빌드 점검: npm run build
- 코드 구조 검토:
  - 상태 관리: app/src/state/context.tsx, app/src/state/reducer.ts
  - 화면/렌더링: app/src/App.tsx
  - 엑셀 출력: app/src/export/excelExport.ts

## 2. 점검 결과 요약

- 치명적 런타임 오류는 확인되지 않음
- lint 오류 1건 존재
- build는 통과하나 번들 크기 경고 존재
- 계산/내보내기 로직에 성능 최적화 여지 존재

## 3. 상세 분석

### 3.1 Lint 오류 1건

- 파일: app/src/state/context.tsx:22
- 내용: react-refresh/only-export-components 규칙 위반
- 원인: 컴포넌트(ProjectProvider)와 훅(useProject)을 같은 파일에서 export
- 영향:
  - 개발 서버는 동작 가능
  - npm run lint 실패로 품질 게이트 통과 불가

### 3.2 빌드 통과 + 번들 경고

- 결과: npm run build는 정상 완료
- 경고: minify 후 500kB 초과 청크 존재(약 684kB)
- 주요 원인 후보:
  - app/src/export/excelExport.ts:1에서 xlsx 정적 import
  - app/src/components/tabs/SummaryTab.tsx:2에서 export 모듈 직접 import
- 영향:
  - 초기 로딩 시 불필요한 코드까지 포함되어 첫 화면 로드 성능 저하 가능

### 3.3 Reducer 재계산 성능 이슈(O(n^2) 패턴)

- 파일: app/src/state/reducer.ts
- 구간:
  - rebuildFrictionAngle (app/src/state/reducer.ts:35)
  - rebuildCohesion (app/src/state/reducer.ts:52)
  - rebuildSubgrade (app/src/state/reducer.ts:88)
  - rebuildAnchor (app/src/state/reducer.ts:106)
  - rebuildPermeability (app/src/state/reducer.ts:122)
  - rebuildFinalSummary (app/src/state/reducer.ts:159)
- 패턴: map 내부에서 반복 find 사용
- 영향:
  - 레이어/보링/측정 데이터 증가 시 입력 반응 지연 가능
  - 액션마다 rebuildAll 호출 구조와 결합되어 누적 비용 증가

### 3.4 Excel 변환 성능 이슈(O(n^2) 패턴)

- 파일: app/src/export/excelExport.ts
- 구간:
  - app/src/export/excelExport.ts:33
  - app/src/export/excelExport.ts:54
  - app/src/export/excelExport.ts:70
  - app/src/export/excelExport.ts:89
  - app/src/export/excelExport.ts:103
  - app/src/export/excelExport.ts:116
- 패턴: 각 map 단계에서 summaries.find(...) 반복
- 영향:
  - 데이터 건수가 많을 때 내보내기 처리 시간 증가

### 3.5 경미한 개선 포인트

- 파일: app/src/App.tsx:41
- 내용: 탭 렌더링 key로 index 사용
- 영향:
  - 현재 탭 구성이 고정이면 실질 문제 가능성은 낮음
  - 향후 탭 구성 변경 시 안정적 key(고유 id/label) 사용이 더 안전

## 4. 우선순위 제안

1. lint 오류 우선 해소 (context 분리 또는 lint 규칙 대응)
2. xlsx 지연 로딩(동적 import)으로 초기 번들 축소
3. reducer/export의 반복 find를 Map 인덱싱으로 개선
4. 탭 key를 안정적 식별자로 정리(선택)

## 5. 결론

- 현재 코드는 실행 가능 수준이며 빌드는 성공함
- 다만 품질 게이트(lint) 1건과 성능 관련 최적화 여지가 명확함
- 단기적으로는 lint 수정 + 번들 최적화, 중기적으로는 계산/내보내기 로직의 인덱싱 최적화가 적절함
