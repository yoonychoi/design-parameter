# 04. 데이터 모델

> 작성일: 2026-02-19

---

## 1. 개요

본 애플리케이션은 DB를 사용하지 않으며, 모든 데이터는 브라우저 메모리(React 상태)에서 관리된다. 아래 데이터 모델은 애플리케이션 상태(State) 구조를 정의한다.

---

## 2. 엔티티 정의

### 2.1 프로젝트 (Project)

최상위 상태 컨테이너. 하나의 산정 세션을 나타낸다.

| 속성 | 타입 | 설명 |
|------|------|------|
| layers | Layer[] | 지층 목록 |
| boreholes | Borehole[] | 시추공 목록 |
| layerSummaries | LayerSummary[] | 지층별 산출 요약 (자동 계산) |

### 2.2 지층 (Layer)

| 속성 | 타입 | 설명 |
|------|------|------|
| id | string | 고유 식별자 |
| name | string | 지층명 (예: 매립층, 풍화토) |
| order | number | 표시 순서 |

### 2.3 시추공 (Borehole)

| 속성 | 타입 | 설명 |
|------|------|------|
| id | string | 고유 식별자 |
| name | string | 공번 (예: BH-01) |
| measurements | Measurement[] | N값 측정 데이터 (가변 길이) |

### 2.4 측정값 (Measurement)

| 속성 | 타입 | 설명 |
|------|------|------|
| id | string | 고유 식별자 |
| depth | number | 심도 순서 |
| layerId | string | 소속 지층 ID (Layer 참조) |
| nValue | number | 표준관입시험 N값 |

### 2.5 지층별 산출 요약 (LayerSummary)

N값 분포에서 자동 산출되며, 후속 모듈의 기초 데이터가 된다.

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| layerName | string | 지층명 |
| count | number | 측정치 수 |
| representativeN | number | 대표 N값 (평균) |

### 2.6 내부마찰각 결과 (FrictionAngleResult)

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| representativeN | number | 대표 N값 (자동) |
| appliedN | number | 적용 N값 (직접 입력, 기본값=대표N값) |
| dunham | number | Dunham 산정값 |
| peck | number | Peck 산정값 |
| meyerhof | number \| null | Meyerhof 산정값 (N<10이면 null) |
| ohsaki | number | Ohsaki 산정값 |
| roadBridge | number | 도로교시방서 산정값 |
| average | number | 평균 (소수점 절사) |
| min | number | 최소값 |
| max | number | 최대값 |
| testValue | number \| null | 시험값 (직접 입력) |
| nearbyData | number \| null | 인근자료 (직접 입력) |
| appliedValue | number | 적용값 |
| applyMode | 'formula' \| 'manual' | 적용 방식 |

### 2.7 점착력 결과 (CohesionResult)

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| appliedN | number | 적용 N값 (선행값) |
| dunham | number | Dunham c값 |
| terzaghiPeck | number | Terzaghi-Peck c값 |
| ohsaki | number | Ohsaki c값 |
| average | number | 평균 |
| min | number | 최소값 |
| max | number | 최대값 |
| testValue | number \| null | 시험값 |
| nearbyData | number \| null | 인근자료 |
| appliedValue | number | 적용값 |
| applyMode | 'formula' \| 'manual' | 적용 방식 |

### 2.8 변형계수 결과 (DeformationModulusResult)

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| appliedN | number | 적용 N값 (선행값) |
| soilType | string | 지층구분 (점토/실트/모래/자갈, 직접 입력) |
| schmertmannAlpha | number \| null | Schmertmann α 계수 (직접 입력) |
| bowlesType | number \| null | Bowles 입력치 (직접 선택) |
| schmertmann | number \| null | Schmertmann 산정값 |
| bowles | number \| null | Bowles 산정값 |
| yoshinaka | number | Yoshinaka 산정값 |
| hisatake | number | Hisatake 산정값 |
| roadBridge | number | 도로교시방서 산정값 |
| foundationStd | number \| null | 구조물기초설계기준 산정값 |
| average | number | 평균 (공란 제외) |
| min | number | 최소값 |
| max | number | 최대값 |
| testValue | number \| null | 시험값 |
| nearbyData | number \| null | 인근자료 |
| appliedValue | number | 적용값 |
| applyMode | 'formula' \| 'manual' | 적용 방식 |

### 2.9 수평지반반력계수 결과 (SubgradeReactionResult)

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| appliedN | number | 적용 N값 (선행값) |
| soilType | string | 지층구분 (선행값) |
| cohesion | number | 점착력 (선행값) |
| calculatedValue | number | 경험식 산정값 |
| appliedValue | number | 적용값 |
| applyMode | 'formula' \| 'manual' | 적용 방식 |

### 2.10 앵커주면마찰저항 결과 (AnchorFrictionResult)

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| appliedN | number | 적용 N값 (선행값) |
| soilType | string | 지층구분 (선행값) |
| groundType | string | 지반의 종류 (모래/점토/암반 등) |
| calculatedValue | number | 산정값 |

### 2.11 투수계수 결과 (PermeabilityResult)

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| soilType | string | 지층구분 (선행값) |
| d10 | number \| null | D10 입력값 (mm) |
| d20 | number \| null | D20 입력값 (mm) |
| hazen | number \| null | Hazen 산정값 (D10 입력 시) |
| creager | number \| null | Creager 산정값 (D20 입력 시) |
| fieldTest | number \| null | 현장시험값 |
| nearbyData | number \| null | 인근자료 |
| appliedValue | number | 적용값 |
| applyMode | 'formula' \| 'manual' | 적용 방식 |
| remark | string | 비고 (적용 근거, 자동) |

### 2.12 최종 요약 (FinalSummary)

| 속성 | 타입 | 설명 |
|------|------|------|
| layerId | string | 지층 ID |
| layerName | string | 지층명 (자동) |
| representativeN | number | 대표 N값 (자동) |
| appliedN | number | 적용 N값 (자동) |
| unitWeight | number \| null | 단위중량 rt (kN/m³, 직접 입력) |
| cohesion | number | 점착력 c (kPa, 자동) |
| frictionAngle | number | 내부마찰각 φ (°, 자동) |
| deformationModulus | number | 변형계수 E (MPa, 자동) |
| subgradeReaction | number | 수평지반반력계수 kh (kN/m³, 자동) |
| permeability | number | 투수계수 k (cm/sec, 자동) |

---

## 3. 엔티티 관계 (ERD)

```
Project
  ├── Layer[] ─────────────────────────┐
  ├── Borehole[]                       │
  │     └── Measurement[]              │
  │           └── layerId ─────────────┤ (참조)
  │                                    │
  └── LayerSummary[] ◄─── (자동 산출)  │
        │                              │
        ▼                              │
  FrictionAngleResult[] ◄── layerId ───┤
        │                              │
        ▼                              │
  CohesionResult[] ◄─── layerId ───────┤
        │                              │
        ▼                              │
  DeformationModulusResult[] ◄─────────┤
        │                              │
        ▼                              │
  SubgradeReactionResult[] ◄───────────┤
        │                              │
        ▼                              │
  AnchorFrictionResult[] ◄─────────────┤
        │                              │
        ▼                              │
  PermeabilityResult[] ◄───────────────┤
        │                              │
        ▼                              │
  FinalSummary[] ◄─────────────────────┘
```

각 Result 엔티티는 layerId를 통해 Layer를 참조하며, 상위 모듈의 적용값을 선행값으로 사용한다.
